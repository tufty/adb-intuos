ADB Intuos notes.

Identification word seems to be the same format as for the Ultrapads - .. .. xx xx yy yy .. ..

Identifiable by having 00 07 as the last two bytes, and by being set to handler 6a

Origin appears to be top left (makes sense).  

We get a continuous stream of packets even if the tool stays stationary.  

Stream starts with 2 packet that are *always* 7 bytes followed by (if there's time, a packet of) 8 bytes, and is always of the form 

80 82 x9 91 01 4f e0
Ax xx xx xx xx xx xx xx

The first packet seems to be an "in proximity" tool indicator.  With the standard stylus, the "x" is 0x2 when we're dealing with the tip, 0xa when we're dealing with the eraser.  Pressure, tilt or buttons don't seem to change it.

Breakdown:

80 TT T9 91 01 4f e0

TTT is Tool ID, as follows:

TTT & 0xFF7 == 0x822 : Standard Stylus
TTT & 0xFF7 == 0x812 : Inking Stylus
TTT & 0xFF7 == 0x832 : Stroke Stylus
TTT & 0xFF7 == 0x842 : Grip Stylus
TTT & 0xFF7 == 0x912 : Airbrush
TTT & 0xFF7 == 0x094 : 4D Mouse
TTT & 0xFF7 == 0x096 : Lens Cursor

TTT & 0x008 == 0x008 : Tool inverted (eraser)

To get a more general tool type, 

TTT & 0xf06 == 0x802 : Stylus
TTT & 0xf06 == 0x902 : Airbrush
TTT & 0xf06 == 0x004 : Mouse
TTT & 0xF06 == 0x006 : Puck

The trailing bytes don't change for my tablet, but are different for Bernard's.  Tablet ID, maybe.

The second packet encodes the "starting point" location.  

Breakdown:

AB XX XX YY YY nn nn nn

XXXX = x location
YYYY = y location

Resolution for 0608-A is 4f60 - 3f70

B is related to buttons, and only active for tip proximity (buttons not detected for eraser)

0bx000 = No buttons
0bx010 = Side button 1 pressed on entry
0bx100 = Side button 2 pressed on entry

Top bit is either set or not, doesn't seem consistent with a particular button state.

Hypothesis :

Pressure is 1024 levels for all tools (and for scrollwheels).  Tilt is +-60 degrees. This can be encoded in 3 bytes. 

First 10 bits appear to be pressure, naively encoded.

Next 7 bits x axis tilt.  zero -> maximum left, 7f -> maximum right
Next 7 bits y axis tilt.  zero -> maximum away from user, 7f -> maximum towards

encoding of last 3 bytes of 8 byte message
pppppppp ppxxxxxx xyyyyyyy


Stream continues with 3 and 6 byte packets, format unknown, and occasional 8 byte packets of the form 

Ax xx xx xx xx xx xx xx

These 8 byte packets appear to be of the same form as the initial entry packets. They are definitely triggered by changes of button state, but not pressure.

Hypothesis : 3 and 6 byte packets deal with most common changes in pointing device state - location, pressure and tilt. "uncommon" changes, i.e. button state changes, necessitate a "full" packet.

3 byte packets.

Bit 21 appears to correspond to a leftwards stroke.  Sign of X delta?
Bit 16 appears to correspond to upwards stroke.  Sign of Y delta?
- bits 12-16 Y delta?
- bits 17-21 X delta?

bits 0-3 y tilt delta ?
bits 4-7 x tilt delta ?
bits 8-11 pressure delta ?

6 byte packets

Appear to be simply a pair of 3 byte packets.

Stream ends with any packet whose last 2 bytes are FE 00 (usually simply 2 bytes, but sometimes 5 or 8 bytes with a 3 or  6 byte "extra" content packet first)




